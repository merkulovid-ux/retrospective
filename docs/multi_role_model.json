{
  "version": "1.0.0",
  "agreements": {
    "DoR": [
      "Value articulated",
      "Acceptance criteria present",
      "Estimate provided",
      "Dependencies clear"
    ],
    "DoD": [
      "Code written",
      "Tests updated/added",
      "Docs updated",
      "CI green",
      "Code reviewed"
    ],
    "rituals": [
      "Planning",
      "Daily",
      "Review",
      "Retrospective",
      "Refinement weekly (~10% capacity)"
    ],
    "wip_limit": 2,
    "branching": "PRs to main; CI must pass; lockfiles committed",
    "issues_projects": "Issues are single source of truth; statuses sync with Project v2"
  },
  "statuses": ["Draft", "Design Review", "Build", "QA", "Ready for Release", "Live"],
  "roles_registry": [
    {"id": "PO", "name": "Product Owner / CEO (Growth)", "mission": "Vision, KPI, release plan, risks/legal.",
     "outputs": ["project_brief", "kpi_targets", "release_plan", "risk_register", "legal_requirements"],
     "intent_signals": ["vision", "kpi", "release", "risk", "legal", "budget", "stakeholder"],
     "handoff_next": ["ARCH", "PM", "PMM"]},
    {"id": "PMM", "name": "Product Marketing Manager", "mission": "Messaging/channels, AB plan.",
     "outputs": ["messaging_map", "ab_plan", "channel_plan"],
     "intent_signals": ["messaging", "positioning", "ab", "channel", "g2m", "launch"],
     "handoff_next": ["UX", "CSEO"]},
    {"id": "UX", "name": "UX/UI & Product Design", "mission": "IA, user flows, tokens, components.",
     "outputs": ["information_architecture", "user_flows", "design_tokens", "components_spec", "copy_deck", "tasks", "a11y_rules", "perf_budget"],
     "intent_signals": ["wireframe", "flow", "component", "token", "ia", "design", "copy"],
     "handoff_next": ["FE", "QA", "CSEO"]},
    {"id": "CSEO", "name": "Content/SEO Lead", "mission": "Copy, SEO, schema.",
     "outputs": ["copy_deck", "seo_brief", "schema_specs", "editorial_guidelines"],
     "intent_signals": ["seo", "copy", "content", "schema.org", "metadata"],
     "handoff_next": ["UX", "FE"]},
    {"id": "FE", "name": "Client Engineer (Web/Native)", "mission": "Client app (web/mobile).",
     "outputs": ["code_diffs", "client_skeleton", "ac_map", "init_scripts", "perf_report_client", "a11y_report"],
     "intent_signals": ["html", "css", "react", "frontend", "ui", "diff", "component"],
     "handoff_next": ["QA", "UX", "DEVOPS"]},
    {"id": "BE", "name": "Backend/Integration Engineer", "mission": "APIs, integrations, DB.",
     "outputs": ["api_contracts", "integration_map", "db_schema", "serverless_funcs", "security_model"],
     "intent_signals": ["api", "backend", "db", "database", "integration", "serverless", "auth"],
     "handoff_next": ["QA", "AN", "FE"]},
    {"id": "QA", "name": "QA Lead", "mission": "Quality: manual/auto/e2e/contract.",
     "outputs": ["test_plan", "test_matrix", "test_cases", "a11y_report", "perf_report", "release_checklist", "defects"],
     "intent_signals": ["test", "qa", "e2e", "checklist", "a11y", "performance"],
     "handoff_next": ["FE", "BE", "DEVOPS"]},
    {"id": "AN", "name": "Analytics/Tracking", "mission": "Tracking & dashboards.",
     "outputs": ["tracking_plan", "events_schema", "dashboards"],
     "intent_signals": ["tracking", "analytics", "event", "dashboard", "kpi"],
     "handoff_next": ["FE", "BE", "PM"]},
    {"id": "MART", "name": "MarTech/Automation", "mission": "CRM/ESP automations.",
     "outputs": ["automation_flows", "message_templates", "consent_logic"],
     "intent_signals": ["crm", "esp", "automation", "email", "consent"],
     "handoff_next": ["AN", "PMM"]},
    {"id": "DEVOPS", "name": "DevOps/Release & Edge Perf", "mission": "Delivery/edge/perf/monitoring.",
     "outputs": ["deploy_playbook", "edge_configs", "monitoring_alerts", "perf_budget_enforced"],
     "intent_signals": ["deploy", "ci", "cd", "monitoring", "edge", "infrastructure", "perf"],
     "handoff_next": ["QA", "FE", "BE"]},
    {"id": "A11Y", "name": "Accessibility Specialist", "mission": "WCAG/assistive tech.",
     "outputs": ["a11y_audit", "fix_list", "assistive_test_log"],
     "intent_signals": ["wcag", "aria", "contrast", "screen reader", "accessibility"],
     "handoff_next": ["FE", "QA", "UX"]},
    {"id": "SEC", "name": "Security & Privacy", "mission": "Security & privacy posture.",
     "outputs": ["threat_model", "privacy_notes", "dpa_checklist"],
     "intent_signals": ["security", "privacy", "threat", "dpa", "gdpr"],
     "handoff_next": ["BE", "DEVOPS"]},
    {"id": "I18N", "name": "Localization Manager", "mission": "i18n/l10n/RTL.",
     "outputs": ["i18n_map", "locale_packs", "bidi_checklist"],
     "intent_signals": ["i18n", "l10n", "rtl", "locale", "translation"],
     "handoff_next": ["FE", "UX"]},
    {"id": "IDEA", "name": "Ideas Polisher", "mission": "Refine ideas: ask 5 Qs, then produce structured description (problem, audience, solution, value, risks, KPI, extensions).",
     "outputs": ["idea_questions", "idea_description"],
     "intent_signals": ["idea", "brainstorm", "concept", "validate"],
     "handoff_next": ["ARCH", "PO"]},
    {"id": "ARCH", "name": "Architect", "mission": "High-level architecture with options, Qs, and final design (FE/API/BE/DB, modules, NFRs, risks).",
     "outputs": ["arch_draft", "arch_final"],
     "intent_signals": ["architecture", "design", "nfr", "module", "system"],
     "handoff_next": ["SYSAN", "FE", "BE"]},
    {"id": "SYSAN", "name": "System Analyst", "mission": "Plan tech docs/tasks; generate docs and index.",
     "outputs": ["tech_docs_plan", "tech_docs_index"],
     "intent_signals": ["spec", "requirements", "srs", "docs"],
     "handoff_next": ["PM", "FE", "BE"]},
    {"id": "PM", "name": "Project Manager", "mission": "Prioritize MVP vs secondary; create tasks index and user-stories with AC.",
     "outputs": ["tasks_index", "user_stories"],
     "intent_signals": ["priority", "mvp", "backlog", "user story", "ac"],
     "handoff_next": ["FE", "BE", "QA"]},
    {"id": "FS", "name": "Full Stack Developer", "mission": "Implement BE/FE with tests; update codebase and run commands.",
     "outputs": ["code_changes", "tests", "codebase_structure"],
     "intent_signals": ["implement", "full-stack", "code", "fix", "refactor"],
     "handoff_next": ["QA", "DEVOPS"]},
    {"id": "SM", "name": "Scrum Master", "mission": "Process facilitation: DoR/DoD, rituals, WIP, metrics, unblockers.",
     "outputs": ["ceremonies_schedule", "metrics_report", "process_improvements"],
     "intent_signals": ["process", "ritual", "dor", "dod", "wip", "impediment"],
     "handoff_next": ["PO", "PM"]}
  ],
  "handoff_flow": [
    "PO -> ARCH|PM|PMM",
    "PMM -> UX|CSEO",
    "UX -> FE|QA|CSEO",
    "CSEO -> UX|FE",
    "IDEA -> ARCH (stop for answers) -> PO",
    "ARCH -> SYSAN (stop for answers) -> FE|BE",
    "SYSAN -> PM (stop) -> FE|BE|QA",
    "PM -> FE|BE|QA",
    "BE -> FE|QA|AN",
    "AN -> FE|BE|PM",
    "FE -> QA|UX|DEVOPS",
    "DEVOPS -> QA|FE|BE",
    "QA -> FE|BE|DEVOPS",
    "PO gate: approve KPI & release criteria"
  ],
  "gates": [
    {"at": "IDEA", "rule": "Stop after 5 questions; wait for answers."},
    {"at": "ARCH", "rule": "Stop after draft & questions; wait for answers."},
    {"at": "SYSAN", "rule": "Stop after plan; wait for 'Ok' to generate docs."},
    {"at": "PM", "rule": "Stop after MVP vs secondary; wait for 'Ok' to generate tasks."}
  ],
  "routing": {
    "strategy": "keyword+heuristic",
    "tie_breaker": "prefer downstream role if user asks for concrete output; otherwise upstream planning role",
    "fallback_role": "SM",
    "max_clarifying_questions": 3,
    "output_contract": {
      "router_block": {
        "fields": ["current_role", "reason", "handoff_to?", "confidence(0..1)"]
      }
    }
  },
  "defaults_ref": "docs/defaults.json"
}
